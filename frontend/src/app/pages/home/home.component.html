<section class="home-screen" [class.has-query]="state.searchQuery().trim().length > 0">
  <div class="search-layout">
    <div class="search-wrap">
      <input
        type="search"
        placeholder="Search recipes"
        [ngModel]="state.searchQuery()"
        (ngModelChange)="state.searchQuery.set($event)"
      />
    </div>

    @if (state.searchQuery().trim().length > 0) {
      <section class="results" [class.loading]="state.loading()">
        @if (state.loading()) {
          <p>Loading</p>
        } @else if (state.searchResults().length === 0) {
          <p>No recipes</p>
        } @else {
          <ul class="recipe-list">
            @for (result of state.searchResults(); track result.recipe.id) {
              <li>
                <button type="button" class="recipe-item" (click)="open(result.recipe.id)">
                  @if (firstThumb(result.recipe); as thumb) {
                    <img [src]="thumb" alt="Recipe image" loading="lazy" />
                  }
                  <span>
                    @for (part of result.titleParts; track $index) {
                      @if (part.highlighted) {
                        <mark>{{ part.text }}</mark>
                      } @else {
                        {{ part.text }}
                      }
                    }
                  </span>
                  <small>
                    {{ result.contentLabel }}:
                    @for (part of result.contentParts; track $index) {
                      @if (part.highlighted) {
                        <mark>{{ part.text }}</mark>
                      } @else {
                        {{ part.text }}
                      }
                    }
                  </small>
                </button>
              </li>
            }
          </ul>
        }
      </section>
    }
  </div>
</section>
