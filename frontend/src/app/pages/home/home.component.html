<section class="home-screen" [class.has-query]="state.searchQuery().trim().length > 0">
  <div class="search-layout">
    <div class="search-wrap">
      <input
        type="search"
        placeholder="Search recipes"
        [ngModel]="state.searchQuery()"
        (ngModelChange)="state.searchQuery.set($event)"
      />
    </div>

    @if (state.searchQuery().trim().length > 0) {
      <section class="results" [class.loading]="state.loading()">
        @if (state.loading()) {
          <p>Loading</p>
        } @else if (state.searchResults().length === 0) {
          <p>No recipes</p>
        } @else {
          <ul class="recipe-list">
            @for (result of state.searchResults(); track trackByRecipeId($index, result)) {
              <li>
                <button type="button" class="recipe-item" (click)="open(result.recipe.id)">
                  <span class="recipe-title">
                    @for (part of result.titleParts; track trackByPartIndex($index, part)) {
                      @if (part.isMatch) {
                        <mark>{{ part.text }}</mark>
                      } @else {
                        <span>{{ part.text }}</span>
                      }
                    }
                  </span>
                  @if (result.contentParts.length > 0) {
                    <span class="recipe-content">
                      <span class="match-label">{{ result.contentLabel }}:</span>
                      @for (part of result.contentParts; track trackByPartIndex($index, part)) {
                        @if (part.isMatch) {
                          <mark>{{ part.text }}</mark>
                        } @else {
                          <span>{{ part.text }}</span>
                        }
                      }
                    </span>
                  }
                </button>
              </li>
            }
          </ul>
        }
      </section>
    }
  </div>
</section>
